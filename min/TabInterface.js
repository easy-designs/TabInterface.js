/*------------------------------------------------------------------------------
Function:		TabInterface()
Author:			Aaron Gustafson (aaron at easy-designs dot net)
Creation Date:	7 December 2006
Version:		1.4
Homepage:		http://github.com/easy-designs/TabInterface.js
License:		MIT License (see MIT-LICENSE)
------------------------------------------------------------------------------*/
function TabInterface(c,d){this.Version="1.4";d=d||(new Date()).getTime();var i=document.createElement("ul"),g={section:document.createElement("section"),li:document.createElement("li")};function e(){var p=["header","h1","h2","h3","h4","h5","h6"],z=false,n,q,s,t,v,w,u,m,x,o,r,y;n=c.getAttribute("id")||"folder-"+d;if(!c.getAttribute("id")){c.setAttribute("id",n)}i.setAttribute("role","tablist");h(i,"index");g.section.setAttribute("role","tabpanel");g.section.setAttribute("aria-hidden","true");g.section.setAttribute("tabindex","-1");h(g.section,"folder");g.li.setAttribute("role","tab");g.li.setAttribute("aria-selected","false");g.li.setAttribute("tabindex","-1");q=c.firstChild;while(q){s=q.nextSibling;if(q.nodeType==3&&!(/\S/).test(q.nodeValue)){c.removeChild(q)}q=s}for(t=0,v=p.length;t<v;t++){if(c.firstChild.nodeName.toLowerCase()==p[t]){z=p[t];break}}if(z){h(c,"tabbed-on");f(c,"tabbed");w=new RegExp("<("+z+")","ig");u=c.innerHTML.replace(w,"||||<$1").split("||||");u.shift();c.innerHTML="";c.appendChild(i);for(t=0,v=u.length;t<v;t++){x=n+"-"+t;r=n+"-"+t+"-tab";m=g.section.cloneNode(true);m.setAttribute("id",x);m.setAttribute("aria-labelledby",r);m.innerHTML=u[t];c.appendChild(m);o=g.li.cloneNode(true);o.setAttribute("id",r);o.setAttribute("aria-controls",x);o.setAttribute("aria-describedby",x);o.onclick=b;o.onfocus=b;o.onkeydown=l;y=m.getElementsByTagName(z)[0];if(y.getAttribute("title")){o.innerHTML=y.getAttribute("title")}else{o.innerHTML=y.innerHTML;h(y,"hidden")}i.appendChild(o);if(t===0){c.setAttribute("aria-activedescendant",x);m.setAttribute("aria-hidden","false");h(m,"visible");o.setAttribute("aria-selected","true");o.setAttribute("tabindex","0");h(o,"active")}}}}function b(q){q=(q)?q:event;var n=c.getAttribute("aria-activedescendant"),p=document.getElementById(n),m=document.getElementById(n+"-tab"),o=j(q.target||q.srcElement),r=document.getElementById(o.getAttribute("aria-controls"));f(m,"active");m.setAttribute("aria-selected","false");m.setAttribute("tabindex","-1");f(p,"visible");p.setAttribute("aria-hidden","true");h(o,"active");o.setAttribute("aria-selected","true");o.setAttribute("tabindex","0");h(r,"visible");r.setAttribute("aria-hidden","false");c.setAttribute("aria-activedescendant",r.getAttribute("id"))}function h(n,o){var m=(!n.className)?[]:n.className.split(" ");m.push(o);n.className=m.join(" ")}function f(o,p){var n=o.className.split(" ");for(var m=n.length-1;m>=0;m--){if(n[m]==p){n.splice(m,1)}}o.className=n.join(" ")}function j(m){while(m.nodeName.toLowerCase()!="li"){m=m.parentNode}return m}function l(p){p=(p)?p:event;var n=j(p.target||p.srcElement),m=p.keyCode||p.charCode,o=true;switch(m){case 13:document.getElementById(_active).focus();o=false;break;case 37:case 38:a(n,"previous",false);o=false;break;case 39:case 40:a(n,"next",false);o=false;break;case 36:a(n,"previous",true);o=false;break;case 35:a(n,"next",true);o=false;break;case 27:n.blur();o=false;break}if(!o){return k(p)}}function a(n,p,m){if(m){if(p=="previous"){n.parentNode.firstChild.focus()}else{n.parentNode.lastChild.focus()}}else{var o=p=="previous"?n.previousSibling:n.nextSibling;if(o){o.focus()}else{if(p=="next"){n.parentNode.firstChild.focus()}else{n.parentNode.lastChild.focus()}}}}function k(m){if(typeof m.stopPropagation=="function"){m.stopPropagation()}else{if(typeof m.cancelBubble!="undefined"){m.cancelBubble=true}}if(m.preventDefault){m.preventDefault()}return false}e()};